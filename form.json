{"name":"Gmail → MCP → Sheets/Calendar","nodes":[{"parameters":{"interval":5,"unit":"minutes"},"id":"1","name":"Schedule Trigger","type":"n8n-nodes-base.scheduleTrigger","typeVersion":1,"position":[200,300]},{"parameters":{"operation":"getAll","resource":"message","returnAll":false,"limit":1,"filters":{"includeSpamTrash":false}},"id":"2","name":"Gmail","type":"n8n-nodes-base.gmail","typeVersion":1,"position":[400,300],"credentials":{"gmailOAuth2":"YOUR_GMAIL_CREDENTIALS"}},{"parameters":{"functionCode":"return items.map(item => {\n  return {\n    json: {\n      email: {\n        from: item.json.payload.headers.find(h => h.name === 'From')?.value || '',\n        subject: item.json.payload.headers.find(h => h.name === 'Subject')?.value || '',\n        body: Buffer.from(item.json.payload.body?.data || '', 'base64').toString('utf8'),\n        dateReceived: item.json.internalDate ? new Date(Number(item.json.internalDate)).toISOString() : ''\n      },\n      task: 'classify_and_extract'\n    }\n  }\n})"},"id":"3","name":"Structure Email for MCP","type":"n8n-nodes-base.function","typeVersion":1,"position":[600,300]},{"parameters":{"requestMethod":"POST","url":"https://your-mcp-server.com/api/classify","jsonParameters":true,"options":{},"bodyParametersJson":"={{ JSON.stringify($json) }}"},"id":"4","name":"Send to MCP Server","type":"n8n-nodes-base.httpRequest","typeVersion":1,"position":[800,300]},{"parameters":{"conditions":{"string":[{"value1":"={{ $json.action }}","operation":"equal","value2":"create_calendar_event"}]}},"id":"5","name":"IF: Create Event?","type":"n8n-nodes-base.if","typeVersion":1,"position":[1000,300]},{"parameters":{"calendar":"primary","start":"={{ $json.event.start }}","end":"={{ new Date(new Date($json.event.start).getTime() + 3600000).toISOString() }}","title":"={{ $json.event.title }}","location":"={{ $json.event.location }}"},"id":"6","name":"Create Calendar Event","type":"n8n-nodes-base.googleCalendar","typeVersion":1,"position":[1200,200],"credentials":{"googleCalendarOAuth2":"YOUR_GOOGLE_CALENDAR_CREDENTIALS"}},{"parameters":{"authentication":"oAuth2","sheetId":"YOUR_SHEET_ID","range":"Sheet1!A1","options":{},"valueInputMode":"RAW","data":[{"range":"Sheet1!A1","values":"={{ [[$json.sheetData.topic, $json.sheetData.scheduledDate, $json.sheetData.sender, $json.sheetData.source]] }}"}]},"id":"7","name":"Append to Google Sheet","type":"n8n-nodes-base.googleSheets","typeVersion":1,"position":[1200,400],"credentials":{"googleSheetsOAuth2":"YOUR_GOOGLE_SHEETS_CREDENTIALS"}}],"connections":{"Schedule Trigger":{"main":[[{"node":"Gmail","type":"main","index":0}]]},"Gmail":{"main":[[{"node":"Structure Email for MCP","type":"main","index":0}]]},"Structure Email for MCP":{"main":[[{"node":"Send to MCP Server","type":"main","index":0}]]},"Send to MCP Server":{"main":[[{"node":"IF: Create Event?","type":"main","index":0}]]},"IF: Create Event?":{"main":[[{"node":"Create Calendar Event","type":"main","index":0}],[{"node":"Append to Google Sheet","type":"main","index":0}]}}}
